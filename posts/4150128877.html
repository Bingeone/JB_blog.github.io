<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Python类和对象 - Bingeone博客园</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Bingeone博客园"><meta name="msapplication-TileImage" content="/img/src/logo.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Bingeone博客园"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="类和对象 局部变量  局部变量就是在函数内部定义的变量 不同的函数可以有相同的变量名，不产生影响 它的作用临时保存函数中使用的数据 （可以在函数内，使用global重新定义变量值，起到修改全局变量的作用）  全局变量 全局变量，在函数外部定义的变量 对于不可变类型的全局变量，需要使用global修改全局变量 对于可变类型的全局变量，不需要global，就可以修改全局变量，例如列表，字典等  LEG"><meta property="og:type" content="blog"><meta property="og:title" content="Python类和对象"><meta property="og:url" content="https://bingeone.top/posts/4150128877.html"><meta property="og:site_name" content="Bingeone博客园"><meta property="og:description" content="类和对象 局部变量  局部变量就是在函数内部定义的变量 不同的函数可以有相同的变量名，不产生影响 它的作用临时保存函数中使用的数据 （可以在函数内，使用global重新定义变量值，起到修改全局变量的作用）  全局变量 全局变量，在函数外部定义的变量 对于不可变类型的全局变量，需要使用global修改全局变量 对于可变类型的全局变量，不需要global，就可以修改全局变量，例如列表，字典等  LEG"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://borisliu.gitbooks.io/from-python-to-django/content/introduction/using_python.jpg"><meta property="article:published_time" content="2021-12-11T03:55:03.167Z"><meta property="article:modified_time" content="2021-12-11T04:31:49.669Z"><meta property="article:author" content="Bingeone"><meta property="article:tag" content="python"><meta property="article:tag" content="程序"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://borisliu.gitbooks.io/from-python-to-django/content/introduction/using_python.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://bingeone.top/posts/4150128877.html"},"headline":"Python类和对象","image":["https://borisliu.gitbooks.io/from-python-to-django/content/introduction/using_python.jpg"],"datePublished":"2021-12-11T03:55:03.167Z","dateModified":"2021-12-11T04:31:49.669Z","author":{"@type":"Person","name":"Bingeone"},"publisher":{"@type":"Organization","name":"Bingeone博客园","logo":{"@type":"ImageObject","url":{"light":"/img/src/mylogo.png","dark":"/img/src/mylogo.png"}}},"description":"类和对象 局部变量  局部变量就是在函数内部定义的变量 不同的函数可以有相同的变量名，不产生影响 它的作用临时保存函数中使用的数据 （可以在函数内，使用global重新定义变量值，起到修改全局变量的作用）  全局变量 全局变量，在函数外部定义的变量 对于不可变类型的全局变量，需要使用global修改全局变量 对于可变类型的全局变量，不需要global，就可以修改全局变量，例如列表，字典等  LEG"}</script><link rel="canonical" href="https://bingeone.top/posts/4150128877.html"><link rel="icon" href="/img/src/logo.png"><link rel="stylesheet" href="/css/font/fontawesome/css2/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="/css/font/font.css"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><!--!--><!--!--><script src="https://zz.bdstatic.com/linksubmit/push.js" defer></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><script type="text/javascript" src="/js/night/night.js"></script><canvas id="universe"></canvas><nav class="navbar navbar-main is-sticky"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img class="logo-img" src="/img/src/mylogo.png" alt="Bingeone博客园" height="28"><img class="logo-img-dark" src="/img/src/mylogo.png" alt="Bingeone博客园" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/bookmark">书签</a><a class="navbar-item" href="/talking">说说</a><a class="navbar-item" href="/friends">友链</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item night" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon" style="color:#d4237a"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><link rel="stylesheet" href="/css/iconfont.css"><i class="iconfont icon-sousuo3"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-12-11T03:55:03.167Z" title="2021/12/11 上午11:55:03">2021-12-11</time>发表</span><span class="level-item"><time dateTime="2021-12-11T04:31:49.669Z" title="2021/12/11 下午12:31:49">2021-12-11</time>更新</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span><script type="text/javascript" src="/js/busuanzi.mini.js"></script></div></div><h1 class="title is-3 is-size-4-mobile">Python类和对象</h1><div class="content"><h3 id="类和对象"><a href="#类和对象" class="headerlink" title="类和对象"></a>类和对象</h3><ol>
<li><p>局部变量</p>
<p> 局部变量就是在函数内部定义的变量<br> 不同的函数可以有相同的变量名，不产生影响<br> 它的作用临时保存函数中使用的数据 （可以在函数内，使用global重新定义变量值，起到修改全局变量的作用）</p>
</li>
<li><p>全局变量<br> 全局变量，在函数外部定义的变量<br> 对于不可变类型的全局变量，需要使用global修改全局变量<br> 对于可变类型的全局变量，不需要global，就可以修改全局变量，例如列表，字典等</p>
</li>
<li><p>LEGB 规则<br> 在python中查找“名称“时，是按照LEGB规则查找：local–&gt;Enclosed–&gt;Global–&gt;Built in<br> local            指函数或者类的方法内部<br> Enclosed        指嵌套函数<br> Global        指模块中的全局变量<br> Built in         指python为自己保留的特殊名称</p>
</li>
<li><p>面对对象(object)—— 一种”设计者“思维，协同合作，编写大规模程序(对象之间的关系)<br> 面向过程(procedure)—— 一种”执行者“思维，不需要协作，编写小规模程序(程序的逻辑流程)</p>
 <span id="more"></span></li>
<li><p>实例方法：从属于实例对象的方法    格式</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">object</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span>	方法名(<span class="params">self，[形参列表]</span>):</span></span><br><span class="line">		函数体</span><br><span class="line">    </span><br><span class="line"><span class="comment">#方法的调用格式</span></span><br><span class="line"><span class="built_in">object</span>.方法名（[实参列表]）</span><br><span class="line"></span><br><span class="line"><span class="built_in">dir</span>(<span class="built_in">object</span>)	获取对象的所有的属性、方法</span><br><span class="line"><span class="built_in">object</span>. __dict__	对象的属性字典</span><br><span class="line"><span class="keyword">pass</span>		空语句</span><br><span class="line"><span class="built_in">isinstance</span>(对象，类型)	判断<span class="string">&#x27;对象&#x27;</span>是不是<span class="string">&#x27;指定类型&#x27;</span></span><br></pre></td></tr></table></figure>

<ol start="6">
<li>类属性和类方法: 类方法操作（调用）类属性    </li>
</ol>
<blockquote>
<p>类属性从属于“类对象”的属性，也称为“类变量”，可以被所有实例对象共享</p>
<p>类方法从属于“类对象”的方法，类方法通过装饰器@classmethod来定义</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义的格式：</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> 类名：</span></span><br><span class="line"><span class="class">	类变量名=初始值</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">	@<span class="title">classmethod</span></span></span><br><span class="line"><span class="class">	<span class="title">def</span>	类方法名(<span class="params">cls, [形参列表]</span>)：</span></span><br><span class="line"><span class="class">		函数体</span></span><br><span class="line"><span class="class"># 在类中或者类外面，读写方式：</span></span><br><span class="line"><span class="class">类名.类变量名</span></span><br><span class="line"><span class="class"># 调用类方法</span></span><br><span class="line"><span class="class">类名.类方法名（参数列表）</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>@classmethon 必须在方法上面一行<br>第一个self必须要，指的就是“类对象”本身<br>调用类方法格式：    类名.类方法名（参数列表）<br>类方法中访问实例属性和实例方法会导致错误<br>子类继承父类方法时，传入cls是子类对象，而非父类对象</p>
</blockquote>
<p><code>静态方法:</code>python中允许定义与“类对象”无关的方法，<br>“静态方法”和模板中定义的普通函数没有区别，只不过“静态方法”放到了“类的名字空间里面”，需要通过“类调用”。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#定义的格式：</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> 类名：</span></span><br><span class="line"><span class="class">	类变量名=初始值</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">	@<span class="title">staticmethod</span></span></span><br><span class="line"><span class="class">	<span class="title">def</span> 静态方法名（[形参列表]）:</span></span><br><span class="line">		函数体</span><br><span class="line"><span class="comment"># 在类中或者类外面，读写方式：</span></span><br><span class="line">类名.类变量名</span><br><span class="line"><span class="comment"># 调用静态方法</span></span><br><span class="line">类名.静态方法名([形参列表])</span><br></pre></td></tr></table></figure>

<blockquote>
<p>@staticmethod 必须在方法的上面一行<br>调用静态方法的格式：    类名.静态方法名([形参列表])<br>静态方法中访问实例属性和实例方法会导致错误</p>
</blockquote>
<ol start="7">
<li><p>方法没有重载<br> 如果我们定义了多个重名的方法，只有最后一个有效，这就是Python中没有方法重载！</p>
</li>
<li><p><strong>私有属性和私有方法（实现封装）</strong></p>
<p> python 对于类成员没有严格的访问限制，与其他语言有区别，要点：<br> a. 通常我们约定,两个下滑线开头的属性是私有的(private),其他公共的(public)<br> b. 类的内部可以访问私有属性(方法)<br> c. 类的外部不能直接访问属性(方法)<br> d. 类的外部可以通过”__类名__私有属性(方法)名” 进行访问</p>
</li>
<li><p><strong>@property (属性)  get和set的方法</strong></p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, salary</span>):</span></span><br><span class="line">        self.__name = name</span><br><span class="line">        self.__salary = salary</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">salary</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.__salary</span><br><span class="line"></span><br><span class="line"><span class="meta">    @salary.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">salary</span>(<span class="params">self,salary</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">1000</span>&lt; salary &lt;<span class="number">50000</span>:</span><br><span class="line">            self.__salary=salary</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;输入有误，工资范围在1000~50000之间&quot;</span>)</span><br><span class="line">        </span><br><span class="line">empl = Employee(<span class="string">&#x27;高崎&#x27;</span>, <span class="number">20000</span>)</span><br><span class="line"><span class="built_in">print</span>(empl.salary)</span><br><span class="line">empl.salary = <span class="number">30000</span></span><br><span class="line"><span class="built_in">print</span>(empl.salary)</span><br></pre></td></tr></table></figure>

<ol start="10">
<li><p><strong>面向对象的三大特征 ：封装、继承、多态</strong></p>
<p><strong>封装</strong>：隐藏对象的属性和实现的细节，只对外提供必要的方法<br><strong>继承</strong>：继承可以让子类继承父类的特性，提高代码的重用性<br><strong>多态</strong>：同一个方法调用由于对象不同产生不同的行为</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 继承语法格式：</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> 子类(<span class="params">父类<span class="number">1</span>[父类<span class="number">2</span>，父类<span class="number">3.</span>..]</span>)</span></span><br><span class="line"><span class="class">	类体</span></span><br></pre></td></tr></table></figure>

<ol start="11">
<li>object根类_dir()</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>(<span class="params">A</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>(<span class="params">B</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(C.mro())</span><br><span class="line">[&lt;<span class="class"><span class="keyword">class</span> &#x27;<span class="title">__main__</span>.<span class="title">C</span>&#x27;&gt;, &lt;<span class="title">class</span> &#x27;<span class="title">__main__</span>.<span class="title">B</span>&#x27;&gt;, &lt;<span class="title">class</span> &#x27;<span class="title">__main__</span>.<span class="title">A</span>&#x27;&gt;, &lt;<span class="title">class</span> &#x27;<span class="title">object</span>&#x27;&gt;]</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>通过类的方法mro()或者类的属性 _mro_ 可以输出这个类的继承层次结构。</p>
<p>object类是所有的类的父类，因此所有的类都有object的属性和方法</p>
</blockquote>
<ol start="12">
<li><p>重写_<em>str</em>_()方法</p>
<p>这里的重写要return返回，不能打印会报错！</p>
</li>
<li><p>多重继承<br>python中支持多重继承，一个子类可以有多个‘直接父类’<br>如果父类中有相同的名字的方法，在子类没有指定父类名时，解释器将‘从左向右’按顺序搜索 即MOR() 方法解释顺序</p>
</li>
<li><p>super() .调用父类的方法</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">say</span>(<span class="params">self</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;A&quot;</span>, self)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>(<span class="params">A</span>):</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">say</span>(<span class="params">self</span>):</span></span><br><span class="line">    <span class="comment"># A.say(self)		# 调用A的方法</span></span><br><span class="line">    <span class="built_in">super</span>().say()		<span class="comment"># 调用A的方法</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;B&quot;</span>, self)</span><br><span class="line">B().say()</span><br></pre></td></tr></table></figure>

<ol start="15">
<li><p><strong>多态</strong>: 指同一个方法调用由于对象不同可能会产生不同的行为。<br>注意：<br>多态是方法的多态，属性没有多态。<br>多态存在有两个必要的条件：继承、方法重写</p>
</li>
<li><p>特殊方法和运算符重载</p>
</li>
<li><p>特殊属性</p>
<p>特殊方法——-含义<br>obj.__dict__    对象的属性字典<br>obj.__class__    对象所属的类<br>class.__bases__    类的基类元组（多继承）<br>class.__base__    类的基类<br>class.__mro__    类层次结构<br>class.__subclasses__()    子类列表</p>
</li>
<li><p><strong>对象的浅拷贝和深拷贝</strong></p>
<p>浅拷贝    拷贝时对象包含子对象内容不拷贝<br>深拷贝    递归拷贝对象中包含的子对象，内容</p>
</li>
<li><p>return 作用特点<br>负责函数返回值<br>退出当前函数，导致return下方的所有代码（函数内部）不执行</p>
</li>
<li><p><strong>设计模式</strong>—工厂模式和单例模式（Singleton Pattern）（常用）    GOF(goup of four)23种设计模式<br>工厂模式：实现了创建者和调用者的分离，使用专门的工厂类将选择实现类、创建对象进行统一的管理和控制。<br>单例模式：核心作用是确保一个类只有一个实例，并且提供一个访问该实例的全局访问点。</p>
</li>
</ol>
<h3 id="python-模块"><a href="#python-模块" class="headerlink" title="python 模块"></a>python 模块</h3><ol>
<li><p><strong>模块</strong>: 只要以.py为后缀的文件，都可以称为模块<br> 包含的东西：变量    函数    class面向对象（类–对象）    可执行代码<br> 优势: 管理方便，易于维护，降低复杂度</p>
</li>
<li><p><strong>模块的使用方法</strong><br> 自定义模块<br> 导入模块：</p>
<p> ​        import 模块名1，模块名2…<br> 导入模块之后怎么使用：<br> ​        模块名.变量<br> ​        模块名.函数名（参数）<br> ​        模块名.类</p>
<p> 导入模块中的相关的数据</p>
<pre><code>     from 模块  import  变量, 函数,类
     (导入之后,可以直接使用)
</code></pre>
</li>
<li><p>自定义模块的定义和使用</p>
<p> 导入自定义模块<br> 问题：在导入模块的时候，模块中的代码也会被执行一次<br> 解决：在自定义模块中，新增控制代码：</p>
<pre><code>     if \_\_name\_\_==&#39;\__main\_\_&#39;:      (# 此处 \_\_name__ 指引到该文件的 路径+名字)
         测试代码
</code></pre>
<p> from 模块 import 方法（函数）（* 代表全部功能）<br> 然后直接使用该方法<br> 注意：在导入全部功能时，如果module中有全局变量，即 __all__ = [],则会功能会失效，需要在在module中改成_<em>all</em>_ = [‘方法1’，’方法2’。。。]</p>
</li>
<li><p>packeage（包）的使用</p>
<p> 包的概念：可以理解为文件夹，在这个文件夹中含有以_<em>init</em>_.py文件<br> 包的作用：</p>
<p> ​        a. 将模块归类，便于管理</p>
<p> ​        b. 防止模块名冲突</p>
<p> 模块中的包，会产生一个新的名字：包名.模块名<br> 例如：</p>
<pre><code> Mymath
 package1.Mymath
</code></pre>
<p> 导入方式：</p>
<p> 方式a：</p>
<p> ​    from Mymath import *</p>
<p> result = add(10,12)</p>
<p> 方式b：</p>
<p> ​    from package1.Mymath import *</p>
<p> result = add(10,12)</p>
</li>
<li><p><strong>自定义模块跨项目使用</strong></p>
</li>
</ol>
<blockquote>
<p>模块的发布</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">a.为什么发布</span><br><span class="line">    自定义模块，切换项目之后，不好使用</span><br><span class="line">    系统模块，切换到新的项目中，可以用</span><br><span class="line">原因：</span><br><span class="line">b.sys.path</span><br><span class="line">    导入模块时，搜索路径列表</span><br><span class="line">    如果所有的路径中都没有导入的模块，会报错无法使用该模块</span><br><span class="line"></span><br><span class="line">模块引入问题</span><br><span class="line">	 <span class="number">1</span>、哪些模块可以引用</span><br><span class="line">    	sys.path</span><br><span class="line">        	存放列表，存储一系列目录</span><br><span class="line">	 <span class="number">2</span>、被引入模块之后，更新问题</span><br><span class="line">    	模块重载：</span><br><span class="line">            <span class="keyword">from</span> imp <span class="keyword">import</span> reload</span><br><span class="line">            reload(目标重载)</span><br><span class="line">            重新调用函数</span><br><span class="line"></span><br><span class="line">解决方法：</span><br><span class="line">    a. 将模块所在路径，手动加入到sys.path中   <span class="comment"># 此处显示报错，原因是在默认的路径中找不到对应的模块，而只有在调用运行时才使用自定义的模块，运行不会报错（手动添加模块的弊端）</span></span><br><span class="line">    b. 将自定义模块，发布到系统目录           <span class="comment"># 发布自定义模块并安装，对所有项目都可用</span></span><br><span class="line">        发布自定义模块的步骤：</span><br><span class="line">            <span class="number">1.</span>确定发布的模块（目录结构）</span><br><span class="line">                |-- setup.py</span><br><span class="line">                |-- package1</span><br><span class="line">                    |</span><br><span class="line">                    --自定义模块 Mymath</span><br><span class="line"></span><br><span class="line">            <span class="number">2.</span>setup的编辑工作</span><br><span class="line">                setup()</span><br><span class="line">                    <span class="keyword">from</span> distutils.core <span class="keyword">import</span> setup</span><br><span class="line">                    setup(name=<span class="string">&#x27;自定义压缩包&#x27;</span>,version=<span class="string">&#x27;1.0&#x27;</span>,description=<span class="string">&#x27;四则运算&#x27;</span>,author=<span class="string">&#x27;wjb&#x27;</span>,py_modules=[<span class="string">&#x27;package1.Mymath&#x27;</span>,<span class="string">&#x27;package1.模块&#x27;</span>,])</span><br><span class="line"></span><br><span class="line">            <span class="number">3.</span>构建模块</span><br><span class="line">                python setup.py build	<span class="comment"># 在命令行中，切换到setup.py 文件目录下，运行该命令，会生成build文件</span></span><br><span class="line">            <span class="number">4.</span>发布模块</span><br><span class="line">                python setup.py sdist	<span class="comment"># 在命令行中，切换到setup.py 文件目录下，运行该命令，会生成dist文件，里面含有安装文件包</span></span><br></pre></td></tr></table></figure>
<p>​        </p>
<blockquote>
<p>模块的安装</p>
</blockquote>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">通过命令形式安装（推荐），更安全</span><br><span class="line">a.找到之前发布的压缩包，解压操作<span class="comment"># 在dist文件中，正常解压 .tar.gz压缩包（此为先前发布产生的压缩包）</span></span><br><span class="line">b.python setup.py install<span class="comment"># 在命令行中切换到解压的文件目录下，运行该命令</span></span><br><span class="line">暴力安装</span><br><span class="line">	直接将安装的包，以及模块，复制到对应的系统目录中</span><br></pre></td></tr></table></figure>



<h3 id="错误和异常"><a href="#错误和异常" class="headerlink" title="错误和异常"></a>错误和异常</h3><ol>
<li>语法错误</li>
</ol>
<blockquote>
<p>SyntaxError: invalid syntax</p>
<p>解析器会复现出现句法错误的代码行，并用小“箭头”指向行里检测到的第一个错误</p>
</blockquote>
<ol start="2">
<li>执行时检测到的错误称为 <em><strong>异常</strong></em>，异常不一定导致严重的后果</li>
</ol>
<blockquote>
<p>python内置异常常见，详细内置异常类型及含义可查阅<a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/index.html">官网</a></p>
</blockquote>
<table>
<thead>
<tr>
<th>异常名称</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>BaseException</td>
<td>所有异常基类</td>
</tr>
<tr>
<td>SystemExit</td>
<td>解释器请求退出</td>
</tr>
<tr>
<td>Exception</td>
<td>常规错误基类</td>
</tr>
<tr>
<td>StopIteration</td>
<td>迭代器没有更多的值</td>
</tr>
<tr>
<td>GeneratorExit</td>
<td>生成器(generator)发生异常来通知退出</td>
</tr>
<tr>
<td>ArithmeticError</td>
<td>所有数值计算错误的基类</td>
</tr>
<tr>
<td>FloatingPointError</td>
<td>浮点计算错误</td>
</tr>
<tr>
<td>ZeroDivisionError</td>
<td>除(或取模)零(所有数据类型)</td>
</tr>
<tr>
<td>AssertionError</td>
<td>断言语句失败</td>
</tr>
<tr>
<td>AttributeError</td>
<td>对象没有这个属性</td>
</tr>
<tr>
<td>IOError</td>
<td>输入/输出操作失败</td>
</tr>
<tr>
<td>IndexError</td>
<td>序列中没有此索引(index)</td>
</tr>
<tr>
<td>KeyError</td>
<td>映射中没有这个键</td>
</tr>
<tr>
<td>NameError</td>
<td>未声明/初始化对象</td>
</tr>
<tr>
<td>SyntaxError</td>
<td>语法错误</td>
</tr>
<tr>
<td>ValueError</td>
<td>传入无效的参数</td>
</tr>
<tr>
<td>Waring</td>
<td>警告的基类</td>
</tr>
<tr>
<td>SyntaxWarning</td>
<td>可疑的语法警告</td>
</tr>
</tbody></table>
<ol start="3">
<li>异常的处理</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        x = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Please enter a number: &quot;</span>))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Oops!  That was no valid number.  Try again...&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>try</strong>语句的工作流程：</p>
<ul>
<li>首先，执行try语句部分内容</li>
<li>假如没有触发异常，则会跳过except子句，执行完成try语句</li>
<li>如果在执行 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/reference/compound_stmts.html#try"><code>try</code></a> 子句时发生了异常，则跳过该子句中剩下的部分。 如果异常的类型与 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/reference/compound_stmts.html#except"><code>except</code></a> 关键字后指定的异常相匹配，则会执行 <em>except 子句</em>，然后跳到 try/except 代码块之后继续执行。</li>
<li>如果发生的异常与 <em>except 子句</em> 中指定的异常不匹配，则它会被传递到外部的 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/reference/compound_stmts.html#try"><code>try</code></a> 语句中；如果没有找到处理程序，则它是一个 <em>未处理异常</em> 且执行将终止并输出如上所示的消息。</li>
</ul>
<p><strong>except</strong>子句：可以用带圆括号的元组来指定多个异常</p>
<ul>
<li>如果发生的异常与 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/reference/compound_stmts.html#except"><code>except</code></a> 子句中的类是同一个类或是它的基类时，则该类与该异常相兼容</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>(<span class="params">Exception</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>(<span class="params">B</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span>(<span class="params">C</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> cls <span class="keyword">in</span> [B, C, D]:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">raise</span> cls()</span><br><span class="line">    <span class="keyword">except</span> D:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;D&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> C:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;C&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> B:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;B&quot;</span>)</span><br><span class="line"><span class="comment"># 结果</span></span><br><span class="line">B</span><br><span class="line">C</span><br><span class="line">D</span><br></pre></td></tr></table></figure>

<blockquote>
<p>请注意如果颠倒 <em>except 子句</em> 的顺序（把 <code>except B</code> 放在最前），则会输出 B, B, B — 即触发了第一个匹配的 <em>except 子句</em>。</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/reference/compound_stmts.html#try"><code>try</code></a> … <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/reference/compound_stmts.html#except"><code>except</code></a> 语句具有可选的 <em>else 子句</em>，该子句如果存在，它必须放在所有 <em>except 子句</em> 之后。 它适用于 <em>try 子句</em> 没有引发异常但又必须要执行的代码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> arg <span class="keyword">in</span> sys.argv[<span class="number">1</span>:]:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        f = <span class="built_in">open</span>(arg, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span> OSError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;cannot open&#x27;</span>, arg)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(arg, <span class="string">&#x27;has&#x27;</span>, <span class="built_in">len</span>(f.readlines()), <span class="string">&#x27;lines&#x27;</span>)</span><br><span class="line">        f.close()</span><br></pre></td></tr></table></figure>

<p>except 子句可以在异常名称后面指定一个变量。 这个变量会绑定到一个异常实例并将参数存储在 <code>instance.args</code> 中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">raise</span> Exception(<span class="string">&#x27;spam&#x27;</span>, <span class="string">&#x27;eggs&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> inst:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">type</span>(inst))    <span class="comment"># 打印变量类型</span></span><br><span class="line">    <span class="built_in">print</span>(inst.args)     <span class="comment"># 绑定变量</span></span><br><span class="line">    <span class="built_in">print</span>(inst)          <span class="comment"># 直接打印变量字符串</span></span><br><span class="line">                         </span><br><span class="line">    x, y = inst.args     <span class="comment"># 解包变量</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;x =&#x27;</span>, x)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;y =&#x27;</span>, y)</span><br><span class="line"><span class="comment"># 结果</span></span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> &#x27;<span class="title">Exception</span>&#x27;&gt;</span></span><br><span class="line"><span class="class">(<span class="params"><span class="string">&#x27;spam&#x27;</span>, <span class="string">&#x27;eggs&#x27;</span></span>)</span></span><br><span class="line"><span class="class">(<span class="params"><span class="string">&#x27;spam&#x27;</span>, <span class="string">&#x27;eggs&#x27;</span></span>)</span></span><br><span class="line"><span class="class"><span class="title">x</span> = <span class="title">spam</span></span></span><br><span class="line"><span class="class"><span class="title">y</span> = <span class="title">eggs</span></span></span><br></pre></td></tr></table></figure>

<p>异常处理程序不仅会处理在 try 子句中发生的异常，还会处理在 try 子句 中调用（包括间接调用）的函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">try</span>:</span><br><span class="line"><span class="meta">... </span>    this_fails()</span><br><span class="line"><span class="meta">... </span><span class="keyword">except</span> ZeroDivisionError <span class="keyword">as</span> err:</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(<span class="string">&#x27;Handling run-time error:&#x27;</span>, err)</span><br><span class="line"><span class="meta">... </span></span><br><span class="line">Handling run-time error: division by zero</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>触发异常</li>
</ol>
<blockquote>
<p><code>raise</code> 语句支持强制触发指定的异常,唯一参数必须是异常实例或异常类（派生自 <code>Exception</code> 类）</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">try</span>:</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">raise</span> NameError(<span class="string">&#x27;Hiname&#x27;</span>)</span><br><span class="line"><span class="meta">... </span><span class="keyword">except</span> NameError:</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(<span class="string">&#x27;An exception flew by!&#x27;</span>)</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">raise</span></span><br><span class="line"><span class="meta">... </span></span><br><span class="line">An exception flew by!</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">2</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">NameError: Hiname</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>异常连</li>
</ol>
<blockquote>
<p><code>raise</code>语句支持可选的 <code>from</code> 子句，该子句用于启用链式异常</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">func</span>():</span></span><br><span class="line"><span class="meta">... </span>    <span class="keyword">raise</span> ConnectionError</span><br><span class="line"><span class="meta">... </span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">try</span>:</span><br><span class="line"><span class="meta">... </span>    func()</span><br><span class="line"><span class="meta">... </span><span class="keyword">except</span> ConnectionError <span class="keyword">as</span> exc:</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">raise</span> RuntimeError(<span class="string">&#x27;Failed to open database&#x27;</span>) <span class="keyword">from</span> exc</span><br><span class="line"><span class="meta">... </span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">2</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">2</span>, <span class="keyword">in</span> func</span><br><span class="line">ConnectionError</span><br><span class="line"><span class="comment"># 上述异常是以下异常的直接原因</span></span><br><span class="line">The above exception was the direct cause of the following exception:</span><br><span class="line"></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">4</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">RuntimeError: Failed to <span class="built_in">open</span> database</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="6">
<li>用户自定义异常</li>
</ol>
<blockquote>
<p>异常类通常只提供让处理异常的程序提取错误信息的一些属性。创建能触发多个不同错误的模块时，一般只为该模块定义异常基类，然后再根据不同的错误条件，创建指定异常类的子类</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Error</span>(<span class="params">Exception</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Base class for exceptions in this module.&quot;&quot;&quot;</span> <span class="comment"># 异常基类</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">InputError</span>(<span class="params">Error</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Exception raised for errors in the input.	# 异常类的子类，有输入错误引发的异常</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Attributes:</span></span><br><span class="line"><span class="string">        expression -- input expression in which the error occurred</span></span><br><span class="line"><span class="string">        message -- explanation of the error</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, expression, message</span>):</span></span><br><span class="line">        self.expression = expression</span><br><span class="line">        self.message = message</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TransitionError</span>(<span class="params">Error</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Raised when an operation attempts a state transition that&#x27;s not</span></span><br><span class="line"><span class="string">    allowed.	# 当操作尝试状态转换时不允许引发异常。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Attributes:</span></span><br><span class="line"><span class="string">        previous -- state at beginning of transition</span></span><br><span class="line"><span class="string">        next -- attempted new state</span></span><br><span class="line"><span class="string">        message -- explanation of why the specific transition is not allowed</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, previous, <span class="built_in">next</span>, message</span>):</span></span><br><span class="line">        self.previous = previous</span><br><span class="line">        self.<span class="built_in">next</span> = <span class="built_in">next</span></span><br><span class="line">        self.message = message</span><br></pre></td></tr></table></figure>

<ol start="7">
<li>定义清理操作</li>
</ol>
<blockquote>
<p><code>try</code>—<code>finally</code> 特点：</p>
</blockquote>
<ul>
<li>如果执行 <code>try</code> 子句期间触发了某个异常，则某个 <code>except</code> 子句应处理该异常。如果该异常没有 <code>except</code> 子句处理，在 <code>finally</code> 子句执行后会被重新触发</li>
<li><code>except</code> 或 <code>else</code> 子句执行期间也会触发异常。 同样，该异常会在 <code>finally</code> 子句执行之后被重新触发</li>
<li>如果 <code>finally</code> 子句中包含 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/reference/simple_stmts.html#break"><code>break</code></a>、<a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/reference/simple_stmts.html#continue"><code>continue</code></a> 或 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/reference/simple_stmts.html#return"><code>return</code></a> 等语句，异常将不会被重新引发</li>
<li>如果执行 <code>try</code> 语句时遇到 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/reference/simple_stmts.html#break"><code>break</code></a>,、<a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/reference/simple_stmts.html#continue"><code>continue</code></a> 或 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/reference/simple_stmts.html#return"><code>return</code></a> 语句，则 <code>finally</code> 子句在执行 <code>break</code>、<code>continue</code> 或 <code>return</code> 语句之前执行</li>
<li>如果 <code>finally</code> 子句中包含 <code>return</code> 语句，则返回值来自 <code>finally</code> 子句的某个 <code>return</code> 语句的返回值，而不是来自 <code>try</code> 子句的 <code>return</code> 语句的返回值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">divide</span>(<span class="params">x,y</span>):</span></span><br><span class="line"><span class="meta">... </span>    <span class="keyword">try</span>:</span><br><span class="line"><span class="meta">... </span>        result = x/y</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">except</span> ZeroDivisionError:</span><br><span class="line"><span class="meta">... </span>        <span class="built_in">print</span>(<span class="string">&quot;division by zero!&quot;</span>)</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">else</span>:</span><br><span class="line"><span class="meta">... </span>        <span class="built_in">print</span>(<span class="string">&quot;result is&quot;</span>, result)</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">finally</span>:</span><br><span class="line"><span class="meta">... </span>        <span class="built_in">print</span>(<span class="string">&quot;executing finally clause&quot;</span>)</span><br><span class="line"><span class="meta">... </span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>divide(<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">result <span class="keyword">is</span> <span class="number">2.0</span></span><br><span class="line">executing <span class="keyword">finally</span> clause</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>divide(<span class="number">2</span>,<span class="number">0</span>)</span><br><span class="line">division by zero!</span><br><span class="line">executing <span class="keyword">finally</span> clause</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>divide(<span class="string">&quot;2&quot;</span>, <span class="string">&quot;1&quot;</span>)</span><br><span class="line">executing <span class="keyword">finally</span> clause</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">3</span>, <span class="keyword">in</span> divide</span><br><span class="line">TypeError: unsupported operand <span class="built_in">type</span>(s) <span class="keyword">for</span> /: <span class="string">&#x27;str&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;str&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>任何情况下都会执行 <code>finally</code>子句。<code>except</code> 子句不处理两个字符串相除触发的 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/library/exceptions.html#TypeError"><code>TypeError</code></a>，因此会在 <code>finally</code> 子句执行后被重新触发。</p>
</blockquote>
<ol start="8">
<li>预定义的清理操作</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&quot;myfile.txt&quot;</span>):</span><br><span class="line">    <span class="built_in">print</span>(line, end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这个代码的问题在于，执行完代码后，文件在一段不确定的时间内处于打开状态。在简单脚本中这没有问题，但对于较大的应用程序来说可能会出问题。<a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/reference/compound_stmts.html#with"><code>with</code></a> 语句支持以及时、正确的清理的方式使用文件对象：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;myfile.txt&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">        <span class="built_in">print</span>(line, end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>语句执行完毕后，即使在处理行时遇到问题，都会关闭文件 <em>f</em></p>
</blockquote>
</div><hr><div class="article-licensing box"><div class="licensing-title"><p>Python类和对象</p><p><a href="https://bingeone.top/posts/4150128877.html">https://bingeone.top/posts/4150128877.html</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>Bingeone</p></div></div><div class="level-item is-narrow"><div><h6>发布</h6><p>2021-12-11</p></div></div><div class="level-item is-narrow"><div><h6>更新</h6><p>2021-12-11</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><link rel="stylesheet" href="/css/iconfont.css"><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=6119c76e49ea8f00167b1939&amp;product=sop" defer></script></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/posts/1503359168.html"><i class="level-item fas fa-chevron-left"></i><span class="level-item">CSS基础</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/posts/3150049846.html"><span class="level-item">Vscode基础使用文档</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><script src="https://utteranc.es/client.js" repo="Bingeone/blog_comment" issue-term="pathname" label="some-issue-label" theme="boxy-light" crossorigin="anonymous" async></script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><figure class="media-left"><a class="image" href="/posts/1503359168.html"><img src="https://3wa.fr/wp-content/uploads/2020/04/logo-css.png" alt="CSS基础"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-12-11T03:55:03.167Z">2021-12-11</time></p><p class="title"><a href="/posts/1503359168.html">CSS基础</a></p><p class="categories"><a href="/categories/%E7%BC%96%E7%A8%8B/">编程</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/posts/4150128877.html"><img src="https://borisliu.gitbooks.io/from-python-to-django/content/introduction/using_python.jpg" alt="Python类和对象"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-12-11T03:55:03.167Z">2021-12-11</time></p><p class="title"><a href="/posts/4150128877.html">Python类和对象</a></p><p class="categories"><a href="/categories/%E7%BC%96%E7%A8%8B/">编程</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/posts/3150049846.html"><img src="https://img.php.cn/upload/article/000/000/024/5dd3bd77dcdcc543.jpg" alt="Vscode基础使用文档"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-12-11T03:55:03.163Z">2021-12-11</time></p><p class="title"><a href="/posts/3150049846.html">Vscode基础使用文档</a></p><p class="categories"><a href="/categories/%E8%BD%AF%E4%BB%B6/">软件</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/posts/4072117687.html"><img src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=46274188,117569977&amp;fm=26&amp;gp=0.jpg" alt="gcc编译和Cmake使用"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-12-11T03:55:03.163Z">2021-12-11</time></p><p class="title"><a href="/posts/4072117687.html">gcc编译和Cmake使用</a></p><p class="categories"><a href="/categories/%E7%BC%96%E7%A8%8B/">编程</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/posts/2489357851.html"><img src="https://superdevresources.com/wp-content/uploads/2015/01/GIT-logo_300x300.jpg" alt="Git版本控制精简版"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-10-14T11:58:36.998Z">2021-10-14</time></p><p class="title"><a href="/posts/2489357851.html">Git版本控制精简版</a></p><p class="categories"><a href="/categories/%E8%BD%AF%E4%BB%B6/">软件</a></p></div></article></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#类和对象"><span class="level-left"><span class="level-item">1</span><span class="level-item">类和对象</span></span></a></li><li><a class="level is-mobile" href="#python-模块"><span class="level-left"><span class="level-item">2</span><span class="level-item">python 模块</span></span></a></li><li><a class="level is-mobile" href="#错误和异常"><span class="level-left"><span class="level-item">3</span><span class="level-item">错误和异常</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="column-right-shadow is-hidden-widescreen"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img class="logo-img" src="/img/src/mylogo.png" alt="Bingeone博客园" height="28"><img class="logo-img-dark" src="/img/src/mylogo.png" alt="Bingeone博客园" height="28"></a><p class="is-size-7"><span>&copy; 2021 Bingeone</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "⭐本站自 <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> 已坚守 <strong>" + dnum + "</strong> 天 <strong>" + hnum + "</strong> 小时 <strong>" + mnum + "</strong> 分 <strong>" + snum + "</strong> 秒！⭐";
        }var now = new Date();setInterval("createTime('2021/08/01 00:00:00')", 250,"");</script></span><br><span><a href="http://www.baidu.com" target="_blank">琼ICP备000000号(测试)</a> - </span><span>⭐感谢 <strong><span id="busuanzi_value_site_uv">99+</span></strong> 小伙伴的 <strong><span id="busuanzi_value_site_pv">99+</span></strong> 次赏目！⭐</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Star me" href="https://github.com/Bingeone"><i class="iconfont icon-github"></i></a></p></div><div class="sideMusic"><link rel="stylesheet" href="/js/aplayer/APlayer.min.css"><script src="/js/aplayer/APlayer.min.js"></script><script src="/js/aplayer/Meting.min.js"></script><meting-js style="width: auto;height: 1000px;" server="netease" type="playlist" id="6861753000" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="200px" fixed="true"></meting-js></div></div></div></div></footer><script src="/js/jquery-3.4.1.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: null,
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
             'HTML-CSS': {
                 matchFontHeight: false
             },
             SVG: {
                 matchFontHeight: false
             },
             CommonHTML: {
                 matchFontHeight: false
             },
             tex2jax: {
                 inlineMath: [
                     ['$','$'],
                     ['\\(','\\)']
                 ]
             }
         });</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script type="text/javascript" src="/js/night/universe.js"></script><script src="/js/click.js"></script><link rel="stylesheet" href="/js/aplayer/APlayer.min.css"><script type="text/javascript" src="/js/aplayer/APlayer.min.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=6119c76e49ea8f00167b1939&amp;product=sop" async="async"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })
            
        function loadLunbo(){
            $.getScript("/js/zouma/lunbo.js", function () {});
            } 

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});

            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadLunbo();
        });</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"react":{"opacity":0.7},"log":false});</script></body></html>